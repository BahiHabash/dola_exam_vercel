<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <title data-i18n="super_admin_dashboard_title">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…</title>
    <style>
        body {
            font-family: sans-serif;
            background: #f4f6f9;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
        }

        .table-container {
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 12px;
            border-bottom: 1px solid #eee;
            text-align: right;
        }

        th {
            background: #667eea;
            color: white;
        }

        .btn {
            padding: 5px 10px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            color: white;
        }

        .btn-view {
            background: #17a2b8;
        }

        .btn-delete {
            background: #dc3545;
        }

        .logout {
            float: left;
            background: #333;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <div class="container">
        <a href="#" onclick="logout()" class="logout" data-i18n="logout_btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
        <h1 data-i18n="super_admin_header">ğŸ›¡ï¸ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…</h1>
        <p data-i18n="super_admin_subtitle">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† ÙˆØ§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</p>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th data-i18n="th_teacher">Ø§Ù„Ù…Ø¹Ù„Ù…</th>
                        <th data-i18n="th_email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th>
                        <th data-i18n="th_plan">Ø§Ù„Ø®Ø·Ø©</th>
                        <th data-i18n="th_status">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        <th data-i18n="th_exams">Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</th>
                        <th data-i18n="th_actions">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                </thead>
                <tbody id="teachersList">
                    <tr>
                        <td colspan="6" data-i18n="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script src="js/lang.js"></script>
    <script>
        window.onload = function () {
            const token = localStorage.getItem('authToken');
            const userType = localStorage.getItem('userType');

            if (!token || userType !== 'super_admin') {
                window.location.href = 'login.html';
                return;
            }
            loadTeachers();
        };

        function loadTeachers() {
            const token = localStorage.getItem('authToken');
            fetch('/api/super-admin/teachers', {
                headers: { 'Authorization': `Bearer ${token}` }
            })
                .then(res => res.json())
                .then(data => {
                    const tbody = document.getElementById('teachersList');
                    tbody.innerHTML = data.map(t => `
                    <tr>
                        <td>${t.name}</td>
                        <td>${t.email}</td>
                        <td>${t.plan.toUpperCase()}</td>
                        <td>${t.isActive ? window.t('active_status') : window.t('inactive_status')}</td>
                        <td>${t.totalExams}</td>
                        <td>
                            <button class="btn btn-view" onclick="viewDetails(${t.teacherId})">${window.t('btn_details')}</button>
                            <button class="btn btn-delete" onclick="deleteTeacher(${t.teacherId})">${window.t('btn_delete')}</button>
                        </td>
                    </tr>
                `).join('');
                })
                .catch(err => {
                    console.error(err);
                    document.getElementById('teachersList').innerHTML = `<tr><td colspan="6" style="text-align:center; color:red;">${window.t('fetch_error')}</td></tr>`;
                });
        }

        function viewDetails(teacherId) {
            // Navigate to teacher details or show a modal with teacher info
            window.location.href = `teacher-details.html?id=${teacherId}`;
        }

        function deleteTeacher(id) {
            if (!confirm(window.t('confirm_delete_teacher'))) return;
            const token = localStorage.getItem('authToken');
            fetch(`/api/super-admin/teachers/${id}`, {
                method: 'DELETE',
                headers: { 'Authorization': `Bearer ${token}` }
            })
                .then(() => loadTeachers());
        }

        function logout() {
            localStorage.clear();
            window.location.href = 'login.html';
        }
    </script>
</body>

</html>